## Web-ларёк

Web-ларёк — это простой интернет-магазин для веб-разработчиков. В нём можно ознакомиться с каталогом товаров, добавить их в корзину и оформить заказ.

### Используемый стек
- HTML / CSS / TypeScript
- Webpack
- EventEmitter
- API: https://larek-api.nomoreparties.co


Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Общая концепция работы приложения

Приложение основано на упрощенной версии шаблона проектирования MVP. В данном контексте все приложение содержит общий "Presenter", который координирует работу всех View и Model через событийно-ориентированный подход, используя механизм сообщений, которые возникают в результате определенных событий внутри отображений и моделей 

Список доступных по умолчанию событий, а также данные, которые передаются в рамках события описаны ниже для конкретного View или Model  

Для описания товара используется интерфейс `IProduct`:

```ts
interface IProduct {
	id: string;
	description: string;
	image: string;
	title: string;
	category: string;
	price: number | null;
}
```
Для описания возможных способов оплаты заказа используется тип `TOrderPayment`:

```ts
type TOrderPayment = 'cash' | 'card';
```

Для описания заказа используется интерфейс `IOrder`:

```ts
interface IOrder {
	items: IProduct[];
	payment: TOrderPayment;
	address: string;
	email: string;
	phone: string;
}
```
При оформлении заказа, формируется специальный объект для работы с API типа `TOrderInvoice`:

```ts
type TOrderInvoice = Omit<IOrder, 'items'> & {
	items: string[];
	total: number;
};
```

Для отслеживания текущего этапа заказа используется тип `TOrderStep`:

```ts
type TOrderStep = 'shipment' | 'contacts';
```

## Базовые и связующие блоки 

### Базовый класс `API`

Реализует базовый набор сетевых операций с серверным API (получение и отправка данных) 

В качестве набора HTTP методов использует тип `TApiPostMethods`:

```ts
type TApiPostMethods = 'POST' | 'PUT' | 'DELETE'
```

### Базовый класс `EventEmitter`

Обеспечивает работу событий. Его функции: возможность установить и снять слушателей событий, вызвать слушателей при возникновении события

Реализует интерфейс `IEvents`, использует типы `TEmitterEvent`, `TSubscriber`, `TEventName`

### Абстрактный класс `Model`

Специальный абстрактный класс, определяющий конструктор всех моделей приложения (который принимает часть данных дженерика, привязанного к интерфейсу модели, а также инстанс брокера событий, который реализует `IEvents`), а также метод `emitChanges` для сообщения об изменении внутренних данных используя `EventEmitter`

### Абстрактный класс `View` 

Специальный абстрактный класс, определяющий конструктор всех отображений приложения, а также метод для рендера `render` привязанного к отображению DOM элемента с определенным набором параметров `args`, также содержит список привязанных к отображению событий и брокер событий для сообщений о внутренних событиях

Конструктор принимает в качестве аргумента специальный тип `TViewConstructionArgs`, содержащий DOM элемент, привязанный к View, брокер и список доступных событий

Так как View внутри себя может содержать другие View, приложен специальный тип `TViewNested`, который описывает способ хранения дочерних View

## Модели данных (Model)

### Класс `AppState`

Модель данных приложения. По сути является неким глобальным хранилищем данных с набором методов для контролирования 
общего процесса работы приложения (добавление товаров в корзину, детальный просмотр товара, заполнение полей заказа и тд). В данном случае выполняет роль распределителя между товарами, корзиной и заказом

Имеет базовый набор методов для управления приложением:


// Установка этапа оформления заказа

// Установка поля заказа

// Проверка валидности текущего заказа

// Получение ошибок текущего заказа

// Получение полей заказа в виде для взаимодействия с API

// Инициализация нового заказа

// Сброс всех полей заказа

// Проверка на наличие товара в корзине

// Добавление товара в корзину

// Удаление товара из корзины

// Сброс текущего состояния корзины

// Получение цены позиций в корзине


### Класс `ShopAPI`

Специальный компонент для взаимодействия с API магазина (получение списка товара(ов), оформление заказа)

Наследуется от базового класса `API`, при оформлении заказа использует `TOrderInvoice`

## Отображения (View)

### Глобальные компоненты 

Данный набор компонентов необходим для работы со страницей

#### Класс `Page` 

Отображение самой страницы. Контролирует возможность скроллинга 

Наследуется от `View`. 

#### Класс `Header`

Отображение хедера страницы. Содержит отображение счетчика корзины, а также предоставляет возможность по клику на иконку корзины совершать определенные действия

Наследуется от `View`.

#### Класс `Modal`

Отображение модального окна. Предоставляет методы для открытия и закрытия модального окна страницы, а также контролирует собственное содержимое

Наследуется от `View`.

Имеет базовый набор методов для управления активностью модального окна:

// Открыть модальное окно

// Закрыть модальное окно

#### Класс `Form` 

Отображение формы. Контролирует отображение ошибок валидации формы, предоставляет возможности по прослушиванию событий отправки формы, а также внесения изменений в поля формы 

Наследуется от `View`.

### Компоненты корзины

Данный набор компонентов необходим для работы с пользовательской корзиной 

#### Класс `Basket`

Отображение корзины. Содержит набор позиций корзины, общую сумму позиций, а также предоставляет возможность совершения действий по клику на кнопку оформления

Наследуется от `View`.

#### Класс `BasketItem`

Отображение позиции в корзине. Отображает характеристики товара позиции, предоставляет возможность совершать действия по клику на иконку удаления позиции

Наследуется от `View`. 

### Компоненты заказа 

Данный набор компонентов необходим для работы с пользовательским заказов 

#### Класс `OrderShipment`

Отображение формы заказа с полями: способ оплаты, адрес доставки. Наследует возможности компонента формы, управляет состоянием полей способа оплаты и адреса доставки, предоставляет возможность при отправке формы совершать определенные действия

Наследуется от `Form`.

#### Класс `OrderContacts`

Отображение формы заказа с полями email, телефон. Наследует возможности компонента формы, управляет состоянием полей email и адреса телефона, предоставляет возможность при отправке формы совершать определенные действия

Наследуется от `Form`.

#### Класс `OrderSuccess`

Отображение успешности оформления заказа. Содержит информацию о потраченных ресурсах при успешном оформлении заказа

Наследуется от `View`.

### Компоненты товаров

Данный набор компонентов необходим для работы с отображением товаров магазина

#### Класс `Products`

Отображение списка товаров. Содержит набор текущих товаров магазина

Наследуется от `View`.

#### Класс `Product`

Отображение товара. Содержит частичные характеристики товара, а также предоставляет возможность по клику на товар совершать определенные действия

Наследуется от `View`.

#### Класс `ProductPreview`

Детальное отображение товара. Содержит полные характеристики товара, а также предоставляет возможность по клику на кнопку совершать определенные действия

Наследуется от `Product`.